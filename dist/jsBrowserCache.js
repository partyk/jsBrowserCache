!function(e,t){if("function"==typeof define&&define.amd)define(["exports"],t);else if("undefined"!=typeof exports)t(exports);else{var s={};t(s),e.JsBrowserCache=s}}(this,function(e){"use strict";function o(e,t){for(var s=0;s<t.length;s++){var o=t[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),console.info("Creat object JsBrowserCache"),this._options=Object.assign({},{prefix:"cache-",storage:"local"},e||{}),this._seconds=1e3,this._setStorage(),this.testSupportsStorage()}return function(e,t,s){t&&o(e.prototype,t),s&&o(e,s)}(t,[{key:"testSupportsStorage",value:function(){var e="j8EiBTWwQV";if(void 0!==this._supportsStorage)return this._supportsStorage;if(!this._storage)return this._supportsStorage=!1;try{this._setItem(e,"j8EiBTWwQV"),this._removeItem(e),this._supportsStorage=!0}catch(e){console.warn(e),this._IsExceptionOutOfSpace(e)&&this._storage.length?this._supportsStorage=!0:this._supportsStorage=!1}return this._supportsStorage}},{key:"isSupportsStorage",value:function(){return this._supportsStorage||console.warn("Browser does not support storage"),this._supportsStorage}},{key:"setItem",value:function(t,e,s){var o,r=(new Date).getTime();if(!this.isSupportsStorage())return!1;console.info("Actual time stamp: "+r),console.info("Expire: "+(s?r+1*s*this._seconds:"")),o={value:this._jsonToString(e),create:r,expire:s?r+1*s*this._seconds:""},console.info(o);try{return this._removeItem(t),this._setItem(t,this._jsonToString(o)),!0}catch(e){return console.warn(e),!(!this._IsExceptionOutOfSpace(e)||!this._storage.length)&&(this.clearExpirate(),this._setItem(t,this._jsonToString(o)),!!this._getItem(t))}}},{key:"getItem",value:function(e){var t;return this.isSupportsStorage()?(t=this._getItem(e),console.info(t),t?(t=this._stringToJson(t),console.info(t),t.expire&&(new Date).getTime()>t.expire?(console.log('Item "'+e+'" is expired. Item is removed.'),this._removeItem(e),null):this._stringToJson(t.value)):null):null}},{key:"clearExpired",value:function(){var e,t=this;if(!this.isSupportsStorage())return null;if(0<this._storage.length&&0<(e=Object.keys(this._storage).filter(function(e){return 0===e.indexOf(t._options.prefix)})).length)for(var s=0,o=e.length;s<o;s++){var r=e[s].replace(this._options.prefix,""),i=this._stringToJson(this._getItem(r));i.expire&&(new Date).getTime()>i.expire&&(console.info('Item "'+r+'" is expired. Item is removed.'),this._removeItem(r))}}},{key:"_setStorage",value:function(e){try{this._storage="session"!==e?localStorage:sessionStorage}catch(e){this._storage=!1}}},{key:"_setItem",value:function(e,t){this._storage.setItem(this._options.prefix+e,t)}},{key:"_getItem",value:function(e){return this._storage.getItem(this._options.prefix+e)}},{key:"_removeItem",value:function(e){this._storage.removeItem(this._options.prefix+e)}},{key:"_jsonToString",value:function(e){return JSON.stringify(e)}},{key:"_stringToJson",value:function(e){return JSON.parse(e)}},{key:"_IsExceptionOutOfSpace",value:function(e){return e&&"QUOTA_EXCEEDED_ERR"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||"QuotaExceededError"===e.name}}]),t}();e.default=t});
//# sourceMappingURL=JsBrowserCache.js.map